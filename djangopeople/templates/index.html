{% extends "base.html" %}

{% block nav_li_class_home %} class="current"{% endblock %}>

{% block js %}{% load thumbnail %}
<script src="http://www.google.com/jsapi?key={{ api_key }}" type="text/javascript">
</script>
<script type="text/javascript">
google.load('maps', '2');

var people = [
    // latitude, longitude, name, username, location description
    {% for person in recent_people %}
    [{{ person.latitude }}, {{ person.longitude }}, "{{ person|escapejs }}", "{{ person.user.username|escapejs }}", "{{ person.location_description|escapejs }}", "{% if person.photo %}{% thumbnail person.photo 40x40 crop %}{% else %}/static/img/person_small_blank.png{% endif %}", "{{ person.country.iso_code|lower }}"]{% if not forloop.last %},{% endif %}
    {% endfor %}
];

window.onload = function() {
    window.gmap = new google.maps.Map2(document.getElementById('gmap'));
    gmap.addControl(new google.maps.LargeMapControl());
    gmap.addControl(new google.maps.MapTypeControl());
    
//    gmap.setCenter(new google.maps.LatLng(43.834526782236814, -37.265625), 2);
    gmap.setCenter(new google.maps.LatLng(19.97335, -15.8203), 2);
    // Plot the people as markers
    $.each(people, function() {
        var lat = this[0];
        var lon = this[1];
        var name = this[2];
        var username = this[3];
        var location_description = this[4];
        var photo = this[5];
        var iso_code = this[6];
        var point = new google.maps.LatLng(lat, lon);
        var marker = new google.maps.Marker(point, getMarkerOpts());
        gmap.addOverlay(marker);
        // Hook up the marker click event
        google.maps.Event.addListener(marker, 'click', function() {
            marker.openInfoWindow(makeWindow(
                name, username, location_description, photo, iso_code, 
                lat, lon
            ));
        });
    });
};
</script>

{% endblock %}

{% block count %}<p>The worldwide community of martial artists</p> {% endblock %}

{% block map %}
    <div class="mapContainer major">
        <div id="gmap">&nbsp;</div>
    </div>
{% endblock %}

{% block content %}

	<div id="intro-box">
		<h3>What is kungfu people?</h3>
		<p>Kungfu People lets martial artists place themselves on the global martial arts map. Create your profile, and find other fellow enthusiasts in your area.</p>
	</div>
	<div id="content-box">
		<div id="inside-left">
		<h3>What's new today?</h3>
		<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>

		<p>ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
	    <p><strong>What is kung fu?</strong> {{ definition.what_is_kungfu }} (says <a href="/{{ definition.user }}/">{{ definition.user.get_full_name }}</a>)</p>
	    <p><strong>White Cranes:</strong> {{ styles }}</p>
	    <p>Chris count today = {{ total_chris }}</p>
	    <p>Videos by our users = {{ total_videos }}</p>
	    <p>Showing {{ recent_people|length }} recent signups (out of {{ total_people }}){% if user.is_anonymous %} - if you're a kung fu stylist, why not <a href="/signup/">add yourself</a> to the site?{% endif %}</p>
		</div>
		
		<div id="inside-right">
			<h3>Latest members</h3>
				<ul class="latest-list">
			        	{% for person in recent_people %}
        	    			<li class="latest-list">
        	        		<img src="{% if person.photo %}{% thumbnail person.photo 40x40 crop %}{% else %}/static/img/person_small_blank.png{% endif %}" alt="{{ person }}" class="latest">
 			       	        <a href="{{ person.get_absolute_url }}">{{ person.user.get_full_name }}</a> ({{ person.style }})
        	        		<p class="meta"><a href="/{{ person.country.iso_code|lower }}/" class="nobg"></a> {{ person.location_description }}</p>
                
 					</li>
        				{% endfor %}
				</ul>

		</div>
	    <h2 class="tagline">Discover other martial artists around the world</h2>
        	<!-- <ul class="detailsList split">
        	    {% for person in recent_people %}
        	    <li>
        	        <img src="{% if person.photo %}{% thumbnail person.photo 40x40 crop %}{% else %}/static/img/person_small_blank.png{% endif %}" alt="{{ person }}" class="main">
        	        <a href="{{ person.get_absolute_url }}">{{ person.user.get_full_name }}</a>
        	        <p class="meta"><a href="/{{ person.country.iso_code|lower }}/" class="nobg"><img src="/static/img/flags/{{ person.country.iso_code|lower }}.gif" alt="{{ person.country }}" title="{{ person.country }}"></a> {{ person.location_description }}</p>
                
        	    </li>
        	    {% endfor %}
        	</ul> -->
        	<ul class="detailsList split">
        	    {% for country in countries %}
        	    <li>
        	        <a href="/{{ country.iso_code|lower }}/" class="nobg"><img src="/static/img/flags/{{ country.iso_code|lower }}.gif" alt="{{ country }}" title="{{ country }}"></a> <a href="/{{ country.iso_code|lower }}/"><strong>{{ country }}</strong></a> {{ country.peoplecount }} {% ifequal country.peoplecount 1 %}person{% else %}people{% endifequal %}
        	    </li>
        	    {% endfor %}
        	</ul>
	</div>
{% endblock %}
